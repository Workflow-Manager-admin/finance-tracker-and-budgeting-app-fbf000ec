{"is_source_file": true, "format": "Python", "description": "Source code for authentication endpoints and models in the backend of a finance tracking application. Handles user registration, login, password hashing, JWT token issuance, and maintains in-memory user storage. Defines models, utility functions, and API routes for authentication-related operations.", "external_files": ["fastapi", "fastapi.security", "pydantic", "passlib.context", "jose", "datetime", "uuid"], "external_methods": ["fastapi.APIRouter", "fastapi.HTTPException", "fastapi.status", "fastapi.Depends", "fastapi.Request", "fastapi.security.OAuth2PasswordBearer", "fastapi.security.OAuth2PasswordRequestForm", "pydantic.BaseModel", "pydantic.Field", "pydantic.EmailStr", "passlib.context.CryptContext", "jose.jwt.encode", "jose.jwt.decode", "jose.JWTError", "uuid.uuid4", "datetime.datetime.utcnow", "datetime.timedelta"], "published": ["get_user_by_username", "create_user", "verify_password", "authenticate_user", "create_access_token", "get_current_user", "router"], "classes": [{"name": "User", "description": "Data model representing a user with ID, username, email, and hashed password."}, {"name": "CreateUserRequest", "description": "Request model for creating a new user, including username, email, and password."}, {"name": "LoginRequest", "description": "Request model for user login, including username and password."}, {"name": "AuthResponse", "description": "Response model containing the JWT token, token type, and user ID upon successful authentication or registration."}], "methods": [{"name": "Optional[User] get_user_by_username(username: str)", "description": "Retrieves a user object from the in-memory database by username.", "scope": "", "scopeKind": ""}, {"name": "User create_user(username: str, email: str, password: str)", "description": "Creates and stores a new user with hashed password in the in-memory database.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(plain_password: str, hashed_password: str)", "description": "Verifies a plaintext password against a hashed password using bcrypt.", "scope": "", "scopeKind": ""}, {"name": "Optional[User] authenticate_user(username: str, password: str)", "description": "Authenticates user credentials; returns user if valid.", "scope": "", "scopeKind": ""}, {"name": "create_access_token(data: dict, expires_delta: Optional[timedelta] = None)", "description": "Generates a JWT token with expiry.", "scope": "", "scopeKind": ""}, {"name": "User get_current_user(token: str = Depends(oauth2_scheme))", "description": "Decodes a JWT token to retrieve current user info, raises exception if invalid.", "scope": "", "scopeKind": ""}, {"name": "login_user(form_data: OAuth2PasswordRequestForm = Depends())", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "logout_user(request: Request, current_user: User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "register_user(reg: CreateUserRequest)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "CryptContext.hash", "CryptContext.verify", "uuid.uuid4", "datetime.utcnow"], "search-terms": ["auth", "JWT", "OAuth2PasswordBearer", "create_user", "register", "login", "password hashing", "token issuance"], "state": 2, "file_id": 12, "knowledge_revision": 25, "git_revision": "", "ctags": [{"_type": "tag", "name": "ACCESS_TOKEN_EXPIRE_MINUTES", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^ACCESS_TOKEN_EXPIRE_MINUTES = 60 * 24 * 7  # 1 week$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ALGORITHM", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^ALGORITHM = \"HS256\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "AuthResponse", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^class AuthResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "CreateUserRequest", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^class CreateUserRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LoginRequest", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^class LoginRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SECRET_KEY", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^SECRET_KEY = \"your-secret-key\"  # TODO: Load from environment\\/.env in production!$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "User", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^class User(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "authenticate_user", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^def authenticate_user(username: str, password: str) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "function", "signature": "(username: str, password: str)"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^def create_access_token(data: dict, expires_delta: Optional[timedelta] = None):$/", "language": "Python", "kind": "function", "signature": "(data: dict, expires_delta: Optional[timedelta] = None)"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^def create_user(username: str, email: str, password: str) -> User:$/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(username: str, email: str, password: str)"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^    email: EmailStr = Field(..., example=\"alice@email.com\", description=\"Email address\")$/", "language": "Python", "typeref": "typename:EmailStr", "kind": "variable", "scope": "CreateUserRequest", "scopeKind": "class"}, {"_type": "tag", "name": "fake_users_db", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^fake_users_db = {}$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^def get_current_user(token: str = Depends(oauth2_scheme)) -> User:$/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme))"}, {"_type": "tag", "name": "get_user_by_username", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^def get_user_by_username(username: str) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "function", "signature": "(username: str)"}, {"_type": "tag", "name": "login_user", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^async def login_user(form_data: OAuth2PasswordRequestForm = Depends()):$/", "language": "Python", "kind": "function", "signature": "(form_data: OAuth2PasswordRequestForm = Depends())"}, {"_type": "tag", "name": "logout_user", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^async def logout_user(request: Request, current_user: User = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(request: Request, current_user: User = Depends(get_current_user))"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^    password: str = Field(..., min_length=6, example=\"secret\", description=\"User password\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "CreateUserRequest", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^    password: str = Field(..., min_length=6, example=\"secret\", description=\"User password\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginRequest", "scopeKind": "class"}, {"_type": "tag", "name": "pwd_context", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "register_user", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^async def register_user(reg: CreateUserRequest):$/", "language": "Python", "kind": "function", "signature": "(reg: CreateUserRequest)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^router = APIRouter(prefix=\"\\/auth\", tags=[\"Authentication\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "token_type", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^    token_type: str = \"bearer\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "AuthResponse", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^    username: str = Field(..., example=\"alice\", description=\"Unique username\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "CreateUserRequest", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^    username: str = Field(..., example=\"alice\", description=\"Username\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginRequest", "scopeKind": "class"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/finance-tracker-and-budgeting-app-fbf000ec/finance_tracker_backend/src/api/auth.py", "pattern": "/^def verify_password(plain_password: str, hashed_password: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(plain_password: str, hashed_password: str)"}], "hash": "3ff5fc4efc2f7bc6b3db7a8d64d5f20e", "format-version": 4, "code-base-name": "finance_tracker_backend", "filename": "finance_tracker_backend/src/api/auth.py", "fields": [{"name": "ACCESS_TOKEN_EXPIRE_MINUTES = 60 * 24 * 7  # 1 week", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ALGORITHM = \"HS256\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SECRET_KEY = \"your-secret-key\"  # TODO: Load from environment\\/.env in production!", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "EmailStr email", "scope": "CreateUserRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "fake_users_db = {}", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str password", "scope": "CreateUserRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/auth\", tags=[\"Authentication\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str token_type", "scope": "AuthResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str username", "scope": "CreateUserRequest", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"25": ""}]}